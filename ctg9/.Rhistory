scale_alpha_manual(values=c(0,1))
ggplot(mnmd, aes(x= sname, y=normexp, colour=age)) +
theme_minimal()+
geom_point(size=3, shape=95)+
stat_summary()+
scale_y_continuous(trans="log2")+
facet_grid(~dir, space="free",scales="free" )+
#  geom_boxplot(outlier.shape = NA)+
scale_colour_manual(values=c("cornflower blue", "red3"))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))+
geom_text(colour="black",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=chosen, x=sname, y=8))+
geom_text(colour="forest green",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=in61, x=sname, y=9))+
scale_alpha_manual(values=c(0,1))+
guide(chosen=F)
ggplot(mnmd, aes(x= sname, y=normexp, colour=age)) +
theme_minimal()+
geom_point(size=3, shape=95)+
stat_summary()+
scale_y_continuous(trans="log2")+
facet_grid(~dir, space="free",scales="free" )+
#  geom_boxplot(outlier.shape = NA)+
scale_colour_manual(values=c("cornflower blue", "red3"))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))+
geom_text(colour="black",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=chosen, x=sname, y=8))+
geom_text(colour="forest green",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=in61, x=sname, y=9))+
scale_alpha_manual(values=c(0,1))+
guides(chosen=F)
ggplot(mnmd, aes(x= sname, y=normexp, colour=age)) +
theme_minimal()+
geom_point(size=3, shape=95)+
stat_summary()+
scale_y_continuous(trans="log2")+
facet_grid(~dir, space="free",scales="free" )+
#  geom_boxplot(outlier.shape = NA)+
scale_colour_manual(values=c("cornflower blue", "red3"))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))+
geom_text(colour="black",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=chosen, x=sname, y=8))+
geom_text(colour="forest green",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=in61, x=sname, y=9))+
scale_alpha_manual(values=c(0,1))+
guides(alpha=F)
ggplot(mnmd, aes(x= sname, y=normexp, colour=age)) +
theme_minimal()+
geom_boxplot(outlier.shape = NA)+
scale_y_continuous(trans="log2")+
facet_grid(~dir, space="free",scales="free" )+
#  geom_boxplot(outlier.shape = NA)+
scale_colour_manual(values=c("cornflower blue", "red3"))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))+
geom_text(colour="black",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=chosen, x=sname, y=8))
ggplot(mnmd, aes(x= sname, y=normexp, colour=age)) +
theme_minimal()+
geom_point(size=3, shape=95)+
stat_summary()+
scale_y_continuous(trans="log2")+
facet_grid(~dir, space="free",scales="free" )+
#  geom_boxplot(outlier.shape = NA)+
scale_colour_manual(values=c("cornflower blue", "red3"))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))+
geom_text(colour="black",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=chosen, x=sname, y=8))+
geom_text(colour="forest green",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=in61, x=sname, y=9))+
scale_alpha_manual(values=c(0,1))+
guides(alpha=F)+
xlab("Marker") +
ylab("Normalised Expression")
ggplot(mnmd, aes(x= sname, y=normexp, colour=age)) +
theme_minimal()+
geom_boxplot(outlier.shape = NA)+
scale_y_continuous(trans="log2")+
facet_grid(~dir, space="free",scales="free" )+
#  geom_boxplot(outlier.shape = NA)+
scale_colour_manual(values=c("cornflower blue", "red3"))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))+
geom_text(colour="black",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=chosen, x=sname, y=8))+
geom_text(colour="forest green",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=in61, x=sname, y=9))+
scale_alpha_manual(values=c(0,1))+
guides(alpha=F)+
xlab("Marker") +
ylab("Normalised Expression")
library(stringr)
a <- paste0("S", str_pad(1:360, 3, pad = "0"))
b <- sample(a, 180)
sub("^S00?", "", b)
b
sub("^0", sub("^0"   "", sub("^S", "", b)))
sub("^0","", sub("^0" ,  "", sub("^S", "", b)))
gm <- read.csv("gmark.csv")
setwd("~/Documents/nstringnov17")
##Setup
###Packages
library(rmarkdown)
library(NanoStringNorm)
###Data Import
#We will look at our whole dataset: 108 RNA samples from 3 separate periods.
###Raw
setwd("~/Documents/nstringnov17")
gm <- read.csv("gmark.csv")
setwd("~/Documents/nstringnov17/ctg5and6")
ct5and6.raw <- read.markup.RCC()
setwd("~/Documents/nstringnov17/ctg5hi")
ct5and6hi.raw <- read.markup.RCC()
setwd("~/Documents/nstringnov17/ctg7and8")
ct7and8.raw <- read.markup.RCC()
setwd("~/Documents/nstringnov17/ctg7and8hi")
ct7and8hi.raw <- read.markup.RCC()
setwd("~/Documents/nstringnov17/ctg3and4")
ct3and4.raw <- read.markup.RCC()
setwd("~/Documents/nstringnov17/ctg1and2")
ct1and2.raw <- read.markup.RCC()
setwd("~/Documents/nstringnov17/ctg9")
ct9.raw <- read.markup.RCC()
###Normalised fully
codeset <- read.table("CodeSet.txt")
codeset$shortname <- substr(codeset$Customer_Identifier, 1,2)
Cht <- read.table("CodeSetCountdata.txt")
ctg1and2.norm <- NanoStringNorm(x = ct1and2.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg3and4.norm <- NanoStringNorm(x = ct3and4.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg5and6.norm <- NanoStringNorm(x = ct5and6.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg5and6hi.norm <- NanoStringNorm(x = ct5and6hi.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg7and8.norm <- NanoStringNorm(x = ct7and8.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg7and8hi.norm <- NanoStringNorm(x = ct7and8hi.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg9.norm <- NanoStringNorm(x = ct9.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
#Internal controls only
ctg5and6.intonly <- NanoStringNorm(x = ct5and6.raw, anno = NA, CodeCount ='sum', Background ="mean",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg5and6hi.intonly <- NanoStringNorm(x = ct5and6hi.raw, anno = NA, CodeCount ='sum', Background ="mean",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg7and8.intonly <- NanoStringNorm(x = ct7and8.raw, anno = NA, CodeCount ='sum', Background ="mean",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg7and8hi.intonly <- NanoStringNorm(x = ct7and8hi.raw, anno = NA, CodeCount ='sum', Background ="mean",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg3and4.intonly <- NanoStringNorm(x = ct3and4.raw, anno = NA, CodeCount ='sum', Background ="mean",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg1and2.intonly <- NanoStringNorm(x = ct1and2.raw, anno = NA, CodeCount ='sum', Background ="mean",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg9.intonly <- NanoStringNorm(x = ct9.raw, anno = NA, CodeCount ='sum', Background ="mean",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg1to9intonly <- cbind(ctg1and2.intonly,ctg3and4.intonly, ctg5and6hi.intonly, ctg7and8hi.intonly, ctg9.intonly)
ctg5and6.unnorm <- NanoStringNorm(x = ct5and6.raw, anno = NA, CodeCount ='none', Background ="none",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg5and6hi.unnorm <- NanoStringNorm(x = ct5and6hi.raw, anno = NA, CodeCount ='none', Background ="none",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg7and8.unnorm <- NanoStringNorm(x = ct7and8.raw, anno = NA, CodeCount ='none', Background ="none",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg7and8hi.unnorm <- NanoStringNorm(x = ct7and8hi.raw, anno = NA, CodeCount ='none', Background ="none",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg3and4.unnorm <- NanoStringNorm(x = ct3and4.raw, anno = NA, CodeCount ='none', Background ="none",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg1and2.unnorm <- NanoStringNorm(x = ct1and2.raw, anno = NA, CodeCount ='none', Background ="none",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg9.unnorm <- NanoStringNorm(x = ct9.raw, anno = NA, CodeCount ='none', Background ="none",OtherNorm = "none", round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg1to9un <- cbind(ctg1and2.unnorm,ctg3and4.unnorm, ctg5and6hi.unnorm, ctg7and8hi.unnorm, ctg9.unnorm)
#Column data
colnames(ctg1and2.norm) <- c("C200", "C100", "C50", "C25", "C12", "C6", "CIA", "CIB", "FYA", "FOA", "MYA", "MOA","FYB",	"FOB",	"MYB",	"MOB",	"MOIA",	"MOIB","MOIC",	"MOID",	"CS1X",	"CS0.5X",	"CS0.25XA",	"CS0.25XB")
colnames(ctg1and2.unnorm) <- colnames(ctg1and2.norm)
colnames(ctg3and4.norm) <- c("O1a", "O2a", "Y1a", "Y2a", "OR1a", "OR2a", "YR1a", "YR2a", "FY5a", "FY6a", "FO5a", "FO7a", "O1b", "O2b", "Y1b", "Y2b", "OR1b", "OR2b", "YR1b", "YR2b", "FY7", "FY8", "FO8", "FO9")
colnames(ctg3and4.unnorm) <- colnames(ctg3and4.norm)
colnames(ctg5and6.norm) <- c("SFPA", "SFPB", "LFPA", "LFPB", "SMPA", "SMPB", "LMPA", "LMPB", "LMIA", "LMIB", "LMIC", "LMID", "Abef", "Aun", "Areg", "Bbef", "Bun", "Breg", "Cbef", "Cun", "Creg", "Dbef", "Dun", "Dreg")
colnames(ctg5and6.unnorm) <- colnames(ctg5and6.norm)
colnames(ctg5and6hi.norm) <-  c("SFPA", "SFPB", "LFPA", "LFPB", "SMPA", "SMPB", "LMPA", "LMPB", "LMIA", "LMIB", "LMIC", "LMID", "Abef", "Aun", "Areg", "Bbef", "Bun", "Breg", "Cbef", "Cun", "Creg", "Dbef", "Dun", "Dreg")
colnames(ctg5and6hi.unnorm) <- colnames(ctg5and6hi.norm)
colnames(ctg7and8.norm) <- c("SFPC","SFPD", "LFPC", "LFPD", "SMPC", "SMPD","LMPC", "LMPD", "0mPA", "0mPB", "10mPA", "20mPA", "Ebef", "Eun", "Ereg", "Fbef", "Fun", "Freg", "Gbef", "Gun", "Greg", "LFIA", "LFIB", "20mPB")
colnames(ctg7and8.unnorm) <- colnames(ctg7and8.norm)
colnames(ctg7and8hi.norm) <-c("SFPC","SFPD", "LFPC", "LFPD", "SMPC", "SMPD","LMPC", "LMPD", "0mPA", "0mPB", "10mPA", "20mPA", "Ebef", "Eun", "Ereg", "Fbef", "Fun", "Freg", "Gbef", "Gun", "Greg", "LFIA", "LFIB", "20mPB")
colnames(ctg7and8hi.unnorm) <- colnames(ctg7and8hi.norm)
colnames(ctg9.norm) <- c("LFIC", "LFID", "OmID", "10mIA", "n", "20mIC", "Ibef", "Iun", "Ireg", "Kbef", "Kun", "Kreg")
colnames(ctg9.unnorm) <- colnames(ctg9.norm)
ctg3to9 <- cbind(ctg3and4.norm, ctg5and6hi.norm, ctg7and8hi.norm, ctg9.norm)
ctg1to9 <- cbind(ctg1and2.norm,ctg3and4.norm, ctg5and6hi.norm, ctg7and8hi.norm, ctg9.norm)
colnames(ctg1to9un) <- colnames(ctg1to9)
colnames(ctg1to9intonly) <- colnames(ctg1to9)
sampleinfo <- data.frame(
sample=colnames(ctg1to9),
sex=c(rep("M", 8), rep(c("F", "F", "M", "M"), 2), rep("M", 8), rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 4), rep("F", 28)),
age=c(rep("O",8), rep(c("Y","O","Y","O"),2),rep("O",8),  rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "N", "N", "N", "N"), rep("O", 11), c("N", "O", "O",  "N", "N", "N", "N", "O", "O", "O", "O", "O", "O")),
reg=c(rep("",24), rep(c(rep("", 4), rep("R", 4), rep("", 4)), 2), c(rep("", 12), rep(c("", "", "R"),4 )   ), c(rep("", 12), rep(c("", "", "R"),3 )   ), rep("",11 ), "R", "", "", "R") ,
ctg=c(rep(1, 12), rep(2, 12),rep(3, 12), rep(4, 12), rep(5, 12), rep(6, 12), rep(7, 12), rep(8, 12), rep(9, 12)),
size= c(rep("P",6), "I", "I", rep("P",8),rep("I",4), rep("I",4), rep("P", 32), rep("I", 4), rep("P",27), rep("I", 8), "P", rep("I", 4), rep("I", 8)),
moult = c(rep("", 80), 0,0,10,20,rep("", 11),20,"","", 0,10,"", 20,rep("", 6) ),
exp= c(rep("conc",8), rep("OvY", 12), rep("cut", 4), rep("OvY",4), rep("regen", 4), rep("OvY",8), rep("regen", 4), rep("OvY",4), rep("OvY", 12), rep("regen", 12), rep("OvY", 8), rep("moult", 4),rep("regen", 9), "OvY", "OvY", "moult",  "OvY", "OvY", "moult", "moult", "moult", "moult", rep("regen", 6) ),
prep = c(rep("Luke", 24), rep("Nikos", 8), rep("Luke", 4), rep("Nikos", 8), rep("Luke", 4), rep("Luke", 60))
)
sampleinfo$flag <- FALSE
sampleinfo$flag[c(5,6,7,8,25,31,32, 54, 59, 66,67, 78,90, 97,101)] <- TRUE
#c(23,24,37,43,44, 54, 59, 66,67, 78,90, 97,101)
sampleinfo$type <- paste(sampleinfo$age, sampleinfo$reg, sep="")
sampleinfo$qual <- "ok"
sampleinfo$qual[c(25 , 31 , 32 , 49,  54 , 67  ,76,  90, 101, 104, 107)] <- "bad"
#sampleinfo$moult <- c(rep(NA, 80), 0,0,10,20,rep(NA, 11),20,NA,NA, 0,10,NA, 20,rep(NA, 6) )
#print("Samples as follows (all experiments)")
#print(paste("males: " sum()))
#Housekeeping genes
ctg1and2.whk <- NanoStringNorm(x = ct1and2.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = FALSE);
ctg1and2.whk.norm <- ctg1and2.whk$normalized.data
ctg1and2.whk.raw <- ctg1and2.whk$raw.data
ctg3and4.whk <- NanoStringNorm(x = ct3and4.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = FALSE);
ctg3and4.whk.norm <- ctg3and4.whk$normalized.data
ctg3and4.whk.raw <- ctg3and4.whk$raw.data
ctg5and6.whk <- NanoStringNorm(x = ct5and6.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = FALSE);
ctg5and6.whk.norm <- ctg5and6.whk$normalized.data
ctg5and6.whk.raw <- ctg5and6.whk$raw.data
ctg5and6hi.whk <- NanoStringNorm(x = ct5and6hi.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = FALSE);
ctg5and6hi.whk.norm <- ctg5and6hi.whk$normalized.data
ctg5and6hi.whk.raw <- ctg5and6hi.whk$raw.data
ctg7and8.whk <- NanoStringNorm(x = ct7and8.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = FALSE);
ctg7and8.whk.norm <- ctg7and8.whk$normalized.data
ctg7and8.whk.raw <- ctg7and8.whk$raw.data
ctg7and8hi.whk <- NanoStringNorm(x = ct7and8hi.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = FALSE);
ctg7and8hi.whk.norm <- ctg7and8hi.whk$normalized.data
ctg7and8hi.whk.raw <- ctg7and8hi.whk$raw.data
ctg9.whk <- NanoStringNorm(x = ct9.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = FALSE);
ctg9.whk.norm <- ctg9.whk$normalized.data
ctg9.whk.raw <- ctg9.whk$raw.data
ctg1to9.whk.norm <- cbind(ctg1and2.whk.norm,ctg3and4.whk.norm[,4:27], ctg5and6hi.whk.norm[,4:27], ctg7and8hi.whk.norm[,4:27], ctg9.whk.norm[,4:15])
colnames(ctg1to9.whk.norm) <- c(colnames(ctg1and2.whk.norm[,1:3]), colnames(ctg1to9))
ctg1to9.whk.raw <- cbind(ctg1and2.whk.raw,ctg3and4.whk.raw[,4:27], ctg5and6hi.whk.raw[,4:27], ctg7and8hi.whk.raw[,4:27], ctg9.whk.raw[,4:15])
colnames(ctg1to9.whk.raw) <- c(colnames(ctg1and2.whk.raw[,1:3]), colnames(ctg1to9))
hk.norm <- subset(ctg1to9.whk.norm, ctg1to9.whk.norm[,1] == "Housekeeping")
hk.raw <- subset(ctg1to9.whk.raw, ctg1to9.whk.raw[,1] == "Housekeeping")
geneinf <- data.frame(name=codeset$Customer_Identifier,transl2fc=codeset$log2FoldChange,  dir = ifelse(codeset$log2FoldChange> 0, "downregulated with age", "upregulated with age"))
geneinf$in61 <- geneinf$name %in% gm$marker[gm$dir != "housekeeping"]
##Saving
save(sampleinfo,ctg1to9,ctg1to9intonly,ctg1to9un, codeset,geneinf, hk.norm, hk.raw, file="nov17main_data.rdata")
df <- data.frame(name=c("A", "B", "C"), starts=c(1,4,3), ends=c(4,5,8))
?geom_segment
ggplot(data=df, aes(y=name, x=starts, xend=ends, yend=name))+
geom_segment()
library(ggplot2)
ggplot(data=df, aes(y=name, x=starts, xend=ends, yend=name))+
geom_segment()
ggplot(data=df, aes(y=name, x=starts, xend=ends, yend=name, label=name, colour=label))+
geom_segment(size=5)+
geom_label()
ggplot(data=df, aes(y=name, x=starts, xend=ends, yend=name, label=name, colour=name))+
geom_segment(size=5)+
geom_label()
head(minf)
View(minf)
minf$chosenand <- minf$in61 &minf$chosen
minf$chosenand
minf$chosenand <- minf$in61 &minf$chosen
save(minf ,file="markerchoiceinfo.rdata")
gnmd <- subset(nmd, nmd$chosen== TRUE)
ggplot(data=nmd, aes(x=YvOl2fc, y=ROvOl2fc, label=sname, colour=chosen))+
geom_hline(yintercept=0, colour="black")+
geom_vline(xintercept=0, colour="black")+
theme_minimal()+
xlim(-5,+5)+
ylim(-5,5)+
scale_colour_manual(values= c("grey", "forest green"), name="Marker", labels=c("other","chosen"))+
xlab("Young vs Old Log2 Fold Change") +
ylab("Regenerated vs Old Log2 Fold Change")+
#  geom_rect(inherit.aes=FALSE, xmin=-10, ymin=-10, xmax=0, ymax=0, fill="yellow", alpha=0.004)+
#  geom_rect(inherit.aes=FALSE,xmin=0, ymin=0, xmax=10, ymax=10, fill="yellow", alpha=0.004)+
geom_point( size=1.5)+
geom_abline(inherit.aes=FALSE, intercept=0, slope=1, linetype=2)+
theme(    plot.background = element_rect(fill = "transparent",colour = "transparent") )+
coord_fixed(ratio=1)
ggplot(mnmd, aes(x= sname, y=normexp, colour=age)) +
theme_minimal()+
geom_boxplot(outlier.shape = NA)+
scale_y_continuous(trans="log2")+
facet_grid(~dir, space="free",scales="free" )+
#  geom_boxplot(outlier.shape = NA)+
scale_colour_manual(values=c("cornflower blue", "red3"))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))+
geom_text(colour="black",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=chosen, x=sname, y=8))+
geom_text(colour="forest green",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=in61, x=sname, y=9))+
scale_alpha_manual(values=c(0,1))+
guides(alpha=F)+
xlab("Marker") +
ylab("Normalised Expression")+coord_polar()
ggplot(mnmd, aes(x= sname, y=normexp, colour=age)) +
theme_minimal()+
geom_boxplot(outlier.shape = NA)+
scale_y_continuous(trans="log2")+
facet_grid(~dir, space="free",scales="free" )+
#  geom_boxplot(outlier.shape = NA)+
scale_colour_manual(values=c("cornflower blue", "red3"))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))+
geom_text(colour="black",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=chosen, x=sname, y=8))+
geom_text(colour="forest green",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=in61, x=sname, y=9))+
scale_alpha_manual(values=c(0,1))+
guides(alpha=F)+
xlab("Marker") +
ylab("Normalised Expression")
ggplot(mnmd, aes(x= sname, y=normexp, colour=age)) +
theme_minimal()+
geom_point(size=3, shape=95)+
stat_summary()+
scale_y_continuous(trans="log2")+
facet_grid(~dir, space="free",scales="free" )+
#  geom_boxplot(outlier.shape = NA)+
scale_colour_manual(values=c("cornflower blue", "red3"))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))+
geom_text(colour="black",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=chosen, x=sname, y=8))+
geom_text(colour="forest green",label="*", data=nmd,inherit.aes=FALSE,  aes(alpha=in61, x=sname, y=9))+
scale_alpha_manual(values=c(0,1))+
guides(alpha=F)+
xlab("Marker") +
ylab("Normalised Expression")+coord_polar()
ggbiplot(bc.pca, obs.scale = 1, var.scale = 1, ellipse = FALSE, circle = TRUE, var.axes=FALSE, labels=rownames(tbc), groups=bc.groups)+ggtitle(paste("PCA of Old vs Young (females):", nrow(bcmin) ," markers in both lists"))+
theme_minimal() +
scale_colour_manual(values=c("cornflower blue", "red3", "black"))+
theme(plot.title=element_text(size=8,face="bold"))+coord_polar()
#source("https://bioconductor.org/biocLite.R")
#biocLite("DESeq2")
#source("https://bioconductor.org/biocLite.R")
#biocLite("DESeq2")
library(ggplot2)
library(rmarkdown)
library(gplots)
library(RColorBrewer)
library(reshape2)
library(scales)
library(ggbiplot)
library(devtools)
library(gtools)
library(Rmisc)
library(dplyr)
library(tidyr)
ggbiplot(bc.pca, obs.scale = 1, var.scale = 1, ellipse = FALSE, circle = TRUE, var.axes=FALSE, labels=rownames(tbc), groups=bc.groups)+ggtitle(paste("PCA of Old vs Young (females):", nrow(bcmin) ," markers in both lists"))+
theme_minimal() +
scale_colour_manual(values=c("cornflower blue", "red3", "black"))+
theme(plot.title=element_text(size=8,face="bold"))+coord_polar()
ggbiplot(bc.pca, obs.scale = 1, var.scale = 1, ellipse = FALSE, circle = TRUE, var.axes=FALSE, labels=rownames(tbc), groups=bc.groups)+ggtitle(paste("PCA of Old vs Young (females):", nrow(bcmin) ," markers in both lists"))+
theme_minimal() +
scale_colour_manual(values=c("cornflower blue", "red3", "black"))+
theme(plot.title=element_text(size=8,face="bold"))
df <- data.frame(id = c("letter1","letter1","letter1","letter1",
"letter2","letter2","letter2","letter2","letter2",
"letter3","letter3","letter3"),
in.out = c("In","Out","In","Out", #letter1
"In","Out","Out","In","Out", #letter2
"In","Out","In"), #letter3
date = c("01/04/17", "27/04/17","11/09/17","14/09/17", #letter1
"05/05/17", "15/05/17","30/07/17","05/08/17","18/08/17", #letter2
"13/06/17","24/07/17","21/09/17")  #letter3
)
?spread
df
spread(df, in.out)
spread(df, value='in.out')
spread(df, value=in.out)
spread(df, key=in.out, value=date)
spread(df, key=in.out, value='date')
spread(df, key='in.out', value='date')
ggplot(df, aes(y=id, x=in.out))+geom_point()
ggplot(df, aes(y=id, x=date))+geom_point()
ggplot(df, aes(y=id, x=date))+geom_point()+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
df$group <- c(1,1,2,2,3,3,4,4,5,6,6,7)
ggplot(df, aes(y=id, x=date))+geom_point()+geom_line(group=group)+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
ggplot(df, aes(y=id, x=date))+geom_point()+geom_line(aes(group=group))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
df$group <- c(1,1,2,2,3,3,4,4,5,6,6,7)
df$group <- as.character(c(1,1,2,2,3,3,4,4,5,6,6,7))
ggplot(df, aes(y=id, x=date))+geom_point()+geom_line(aes(group=group))+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
ggplot(df, aes(y=id, x=date, group=group))+geom_point()+geom_line())+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
ggplot(df, aes(y=id, x=date, group=group))+geom_point()+geom_line())+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
ggplot(df, aes(y=id, x=date, group=group))+geom_point()+geom_line()+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
ggplot(df, aes(y=id, x=date,colour=group, group=group))+geom_point()+geom_line()+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
df$group <- c("a", "a", "b", "b", "c", "c", "d", "d", "e", "e", "f")
df$group <- c("a", "a", "b", "b", "c", "c", "d", "e", "e", "f")
df$group <- c("a", "a", "b", "b", "c", "c", "d", "d", "e", "f", "f", "g")
ggplot(df, aes(y=id, x=date,colour=group, group=group))+geom_point()+geom_line()+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
ggplot(df, aes(y=id, x=date,colour=group))+geom_point()+geom_line()+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
ggplot(df, aes(y=group, x=date,colour=group))+geom_point()+geom_line()+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
ggplot(df, aes(y=group, x=date,colour=group, group=group))+geom_point()+geom_line()+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
df <- data.frame(id = c("letter1","letter1","letter1","letter1",
"letter2","letter2","letter2","letter2","letter2",
"letter3","letter3","letter3"),
in.out = c("In","Out","In","Out", #letter1
"In","Out","Out","In","Out", #letter2
"In","Out","In"), #letter3
date = dmy(c("01/04/17", "27/04/17","11/09/17","14/09/17", #letter1
"05/05/17", "15/05/17","30/07/17","05/08/17","18/08/17", #letter2
"13/06/17","24/07/17","21/09/17") ) #letter3
)
library(lubridate)
df <- data.frame(id = c("letter1","letter1","letter1","letter1",
"letter2","letter2","letter2","letter2","letter2",
"letter3","letter3","letter3"),
in.out = c("In","Out","In","Out", #letter1
"In","Out","Out","In","Out", #letter2
"In","Out","In"), #letter3
date = dmy(c("01/04/17", "27/04/17","11/09/17","14/09/17", #letter1
"05/05/17", "15/05/17","30/07/17","05/08/17","18/08/17", #letter2
"13/06/17","24/07/17","21/09/17") ) #letter3
)
View(df)
df$group <- c("a", "a", "b", "b", "c", "c", "d", "d", "e", "f", "f", "g")
ggplot(df, aes(y=group, x=date,colour=group, group=group))+
geom_point()+
geom_line()+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
ggplot(df, aes(y=group, x=date,colour=id, group=group))+
geom_point()+
geom_line()+
theme(axis.text.x = element_text(angle = 60, hjust = 1, size=4))
ggplot(df, aes(y=group, x=date,colour=id, group=group))+
geom_point()+
geom_line()+
theme(axis.text.x = element_text(angle = 60, hjust = 1)
)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id))+
geom_point()+
geom_line()+
geom_label()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id, alpha=in.out))+
geom_point()+
geom_line()+
geom_label()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id, alpha=in.out))+
geom_point()+
geom_line()+
geom_label()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_alpha_manual(values=c(1,0))+
guides(alpha=F)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id, alpha=in.out))+
geom_point()+
geom_line()+
geom_label()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_alpha_manual(values=c(1,0))+
guides(alpha=F)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id, alpha=in.out))+
geom_point()+
geom_line()
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id, alpha=in.out))+
geom_point()+
geom_line()+
geom_label()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_alpha_manual(values=c(1,0))+
guides(alpha=F)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id, alpha=in.out))+
geom_point()+
geom_line(size=5)+
geom_label()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_alpha_manual(values=c(1,0))+
guides(alpha=F)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id, alpha=in.out))+
geom_point()+
geom_line(size=5)+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_alpha_manual(values=c(1,0))+
guides(alpha=F)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id))+
geom_point()+
geom_line(size=5)+
geom_label(aes(alpha=in.out))+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_alpha_manual(values=c(1,0))+
guides(alpha=F)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id))+
geom_point()+
geom_line(size=5)+
geom_text(aes(alpha=in.out))+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_alpha_manual(values=c(1,0))+
guides(alpha=F)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id))+
geom_point()+
geom_line(size=5)+
geom_text(aes(alpha=in.out), size=2)+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_alpha_manual(values=c(1,0))+
guides(alpha=F)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=id))+
geom_point()+
geom_line(size=5)+
geom_text(aes(alpha=in.out), size=4)+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_alpha_manual(values=c(1,0))+
guides(alpha=F)
?geom_label
df$label <- paste(df$id, df$in.out)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=label))+
geom_point()+
geom_line(size=5)+
geom_label()
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=label))+
geom_point()+
geom_line(size=5)+
geom_text(angle=30)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=label))+
geom_point()+
geom_line(size=5)+
geom_text(angle=30, nudge_y=0.5)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=label))+
geom_point()+
geom_line(size=5)+
geom_text(angle=30, nudge_y=0.5)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=label))+
geom_point()+
geom_line(size=5)+
geom_text(angle=30, nudge_y=0.5)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=label))+
geom_point()+
geom_line(size=5)+
geom_text(angle=60, nudge_y=0.5)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=label))+
geom_point()+
geom_line(size=5, alpha=0.5)+
geom_text(angle=60, nudge_y=0.5)
ggplot(df, aes(y=group, x=date,colour=id, group=group, label=label))+
geom_line(size=5, alpha=0.5)+
geom_text(angle=60, nudge_y=0.5)
ggplot(df, aes(y=id, x=date,colour=id, group=group, label=label))+
geom_line(size=5, alpha=0.5)+
geom_text(angle=60, nudge_y=0.5)
